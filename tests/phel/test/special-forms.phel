(ns phel-test\test\special-forms
  (:require phel\test :refer [deftest is]))

(deftest test-set-object-property
  (is (= "foo" (php/-> (php/oset (php/-> (php/new \stdClass) name) "foo") name)) "set value to stdClass"))

(deftest test-nested-php-object-call
  (let [xml-string "<root><user id='1'><name>John</name></user></root>"
        xml (php/new \SimpleXMLElement xml-string)]
    (is (= "John" (str (php/-> xml user name))))))

(deftest test-def-duplication
  (let [form (read-string "(do (def a \"first\") (def a \"second\") a)")]
    (is (= "second" (eval form)))))

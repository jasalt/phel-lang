--PHEL--
(def x :macro (fn [x] (php/array 1 2 (php/array 3 4))))

(def y (x 1))
--PHP--
\Phel::addDefinition(
  "user",
  "x",
  new class() extends \Phel\Lang\AbstractFn {
    public const BOUND_TO = "user\\x";

    public function __invoke($x) {
      return array(1, 2, array(3, 4));
    }
  },
  \PhelType::persistentMapFromKVs(
    \PhelType::keyword("macro"), true,
    \PhelType::keyword("start-location"), \PhelType::persistentMapFromKVs(
      \PhelType::keyword("file"), "MacroExpand/return-array.test",
      \PhelType::keyword("line"), 1,
      \PhelType::keyword("column"), 0
    ),
    \PhelType::keyword("end-location"), \PhelType::persistentMapFromKVs(
      \PhelType::keyword("file"), "MacroExpand/return-array.test",
      \PhelType::keyword("line"), 1,
      \PhelType::keyword("column"), 55
    ),
    "min-arity", 1
  )
);
\Phel::addDefinition(
  "user",
  "y",
  [0 => 1, 1 => 2, 2 => [0 => 3, 1 => 4]],
  \PhelType::persistentMapFromKVs(
    \PhelType::keyword("start-location"), \PhelType::persistentMapFromKVs(
      \PhelType::keyword("file"), "MacroExpand/return-array.test",
      \PhelType::keyword("line"), 3,
      \PhelType::keyword("column"), 0
    ),
    \PhelType::keyword("end-location"), \PhelType::persistentMapFromKVs(
      \PhelType::keyword("file"), "MacroExpand/return-array.test",
      \PhelType::keyword("line"), 3,
      \PhelType::keyword("column"), 13
    )
  )
);
